<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="../../dist/css/page.css"/>
		<link rel="stylesheet" type="text/css" href="../../dist/iconfont/iconfont.css"/>
	</head>
	<body>
		<!--topCon-->
		<div id="topCon">
			<div class="select-con">
				<ul>
					<li><a href="#">免费网</a></li>
					<li><a href="#"><i>淘牛品</i></a></li>
					<li><a href="#">添加收藏</a></li>
				</ul>
				<ul>
					<li><a href="login.html">登录</a></li>
					<li><a href="register.html">注册</a></li>
					<li><a href="#"><em class="iconfont icon-liwuhuodong"></em>积分商城</a></li>
					<li><a href="#"><i>卖家报名</i></a></li>
				</ul>
			</div>
		</div>
		<!--logoCon-->
		<div id="logoCon">
			<div class="logo-l">
				<h1><img src="../image/taoniu-logo.png"/></h1>
			</div>
			<div class="search-c">
				<form action="">
					<input class="txt" type="text">
					<input class="btn" type="submit" value="搜索">
				</form>
			</div>
			<div class="brand-r">
				<img src="../image/brand-i.jpg"/>
				<img src="../image/brand-t.jpg"/>
				<img src="../image/brand-d.jpg"/>
			</div>
		</div>
		<!--topNav-->
		<div id="topNav">
			<ul>
				<button>全部</button>
				<li><a href="#">潮流女装</a></li>
				<li><a href="#">时尚男装</a></li>
				<li><a href="#">男女鞋包</a></li>
				<li><a href="#">配饰礼品</a></li>
				<li><a href="#">吃货美食</a></li>
				<li><a href="#">美妆护肤</a></li>
				<li><a href="#">母婴童装</a></li>
				<li><a href="#">数码周边</a></li>
				<li><a href="#">生活家居</a></li>
				<li><a href="#">文体车品</a></li>
			</ul>
		</div>
		<!--navCon-->
		<div id="navCon">
			<div class="nav-con">
				<ul>
					<li>
						<h2 class="active">商品分类</h2>		
						<div class="nav-list">
							<p><em class="iconfont icon-qunzi"></em><a href="#">女装/连衣裙/短袖</a></p>
							<p><em class="iconfont icon-yifu"></em><a href="#">男装/短裤</a></p>
							<p><em class="iconfont icon-xiezi"></em><a href="#">鞋包/凉鞋/箱包</a></p>
							<p><em class="iconfont icon-icon-test"></em><a href="#">配饰/手表/皮带</a></p>
							<p><em class="iconfont icon-coffee"></em><a href="#">零食/酒水/杂粮</a></p>
							<p><em class="iconfont icon-kouhong"></em><a href="#">美妆/面膜/BB霜</a></p>
							<p><em class="iconfont icon-muyingwanju"></em><a href="#">母婴/童装/玩具</a></p>
							<p><em class="iconfont icon-shubiao"></em><a href="#">数码/耳机/手机</a></p>
							<p><em class="iconfont icon-chazuo-"></em><a href="#">居家/百货/家电</a></p>
							<p><em class="iconfont icon-weibiaoti2fuzhi06"></em><a href="#">文体/办公/户外</a></p>
						</div>
					</li>
					<li><a href="#">首页</a></li>
					<li><a href="#">9.9包邮</a></li>
					<li><a href="#">精品折扣</a></li>
					<li><a href="#">明日预告</a></li>
				</ul>
				<ul>
					<li><a href="#">牛币商城</a></li>
					<li><a href="#"><em class="iconfont icon-qiandao"></em>签到领牛币</a></li>
				</ul>
			</div>
		</div>
		<!--shoplist-->
		<div class="shopList clear_fix">
			<!--<ul class="shop-item">
				<div class="bieBox"><p>今日上新</p></div>
				<img src="../image/shop-1.jpg"/>
				<a href="#">三邦吸壁式免打孔吸盘纸巾架</a>
				<h3>
					<em>￥15.8<i>￥36.6</i></em>
					<button>加入购物车</button>
				</h3>
			</ul>-->
		</div>
		<!--footer-->
		<div id="footer">
			<div class="footer-top">
				<div class="footer-top-left">
					<div class="footer-nav">
						<a href="#">首页</a>
						<a href="#">公司信息</a>
						<a href="#">帮助中心</a>
						<a href="#">携手淘牛品</a>
						<a href="#">下载到桌面</a>
					</div>
					<div class="message">
						<h4>
							<img src="../image/tubiao-weibo.jpg"/>
							<img src="../image/tubiao-weixin.jpg"/>
						</h4>
						<h5>
							<p>- 电信与信息服务业务经营许可证：京ICP证140593号</p>
							<p>Copyright @ 2011-2013 www.taoniupin.com 北京鸿燕科技有限公司</p>
						</h5>
					</div>
				</div>
				<div class="footer-top-right">
					<img src="../image/sao.png"/>
					<img src="../image/bottom-erweima.png"/>
				</div>
			</div>
			<div class="footer-link">
				<p>友情链接:</p>
				<a href="#">9.9全国包邮</a>
				<a href="#">奢侈品</a>
				<a href="#">聚卖网</a>
				<a href="#">女人味</a>
				<a href="#">爱折网</a>
				<a href="#">广州服装批发</a>
				<a href="#">水杯</a>
				<a href="#">葫芦丝</a>
				<a href="#">爱购啦</a>
				<a href="#">九块九包邮</a>
				<a href="#">女人网</a>
				<a href="#">友爱女性论坛</a>
				<a href="#">班服</a>
				<a href="#">优惠券</a>
				<a href="#">百家好女装</a>
				<a href="#">更多>></a>
			</div>
			<div class="footer-bottom">
				<img src="../image/bottom-save.png"/>
				<img src="../image/bottom_large.jpg"/>
			</div>
		</div>
		<!--leftNav-->
		<div id="leftNav">
			<img src="../image/left-nav.gif"/>
		</div>
	</body>
</html>
<script src="../js/jquery-1.11.3.js"></script>
<script src="../js/myCookie.js"></script>
<script>
	$(function(){
		//吸顶效果
		$(window).scroll(function(){
			var sTop = $(document).scrollTop();
			if(sTop > 100){
				$('#topNav').show(1000).css({"position":"fixed","top":"0"});
				$('#leftNav').show(1000).css({"position":"fixed","top":"50%"});
			}else{
				$('#topNav').css("display","none");
				$('#leftNav').css("display","none");
			}
		})
		
		//鼠标移动下拉菜单
		$(".active").mouseenter(function(){
			$(".nav-list").slideDown(800);
		})
		$(".nav-list").mouseleave(function(){
			$(".nav-list").slideUp(800);
		})
		
		var deff = $.ajax({
					type:"get",
					url:"../../dist/json/data.json?id="+Math.random(),
					async:true
				});
		deff.done(function(msg){
			//得到一个json对象  使用 for...in遍历
			var strCon = "";
			for (var attr in msg) {
				//console.log( msg[attr] )
				for( var j = 0 ; j < msg[attr].length; j++ ){ //遍历每一类商品的list  
					var pro = msg[attr][j];
					//console.log(msg[attr][j])
					strCon += `<div class="shop-item">
									<div class="bieBox"><p>今日上新</p></div>
									<img src="../image/${pro.src}"/>
									<a href="details.html?pid=${pro.id}&cname=${attr}">${pro.name}</a>
									<h3>
										<em>￥${pro.price}<i>￥${pro.iprice}</i></em>
										<button data-pid=${pro.id} data-pname=${pro.name} data-price=${pro.price} data-src=${pro.src} data-iprice=${pro.iprice}>加入购物车</button>
									</h3>
								</div>`;
				}
			}
			$(".shopList").html( strCon );//导入内容
		})
		
		//购物车加购
		var arr = []; //存放多个商品对象
		$(".shopList").on( "click" , "button" , function(){
			var json = {};//存放每一个商品对象信息
			json = {
				"id" : $(this).data("pid"),
				"name" : $(this).data("pname"),
				"src" : $(this).data("src"),
				"price" : $(this).data("price"),
				"count":1
			}
			//console.log(json)
			var flag = true;//假设值为true时   可以向数组中push对象
			//判断当前点击的商品在cookie中是否存在  如果存在就将该商品的数量++  否则就将这个新商品存入到数组中
			//取出cookie中的数据
			var brr = getCookie("shoplist")  ;
			
			 
			if( brr.length > 0 ){ //说明cookie中有数据
				//将取出来的cookie数据存入到arr中  最终是要将arr数据存入到cookie中
				arr = brr;
				//判断当前的json对象的id值是否和arr中某个对象的id相等
				for( var i = 0 ; i < arr.length ; i++ ){
					if(arr[i].id == json.id){//说明当前选择的商品在cookie中是存在的
						arr[i].count++;
						flag = false;
						break;
					}
				}
			} 
			
			if( flag ){
				//将对象json添加到数组中
				arr.push(json)
			}
			
			//将数组存入到cookie中
			setCookie( "shoplist" , JSON.stringify( arr ) );//cookie中存入的都是字符串
			if( !confirm("确定-继续购买，取消-跳转到购物车页面") ){
				location.href = "shopcar.html";
			}
		})
	})

</script>
